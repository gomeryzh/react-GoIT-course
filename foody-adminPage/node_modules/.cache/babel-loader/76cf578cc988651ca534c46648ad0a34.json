{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Vova\\\\react-GoIT-course\\\\foody-adminPage\\\\src\\\\components\\\\Admin\\\\Pages\\\\Menu\\\\MenuItemsPage.js\";\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport queryString from 'query-string';\nimport * as api from '../../../../services/menu-api';\nimport MenuList from './MenuList';\nimport CategorySelector from './CategorySelector';\nimport ClearFilter from './ClearFilter';\n\nvar getCategoryFromProps = function getCategoryFromProps(props) {\n  return queryString.parse(props.location.search).category;\n};\n\nvar MenuItemsPage =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MenuItemsPage, _Component);\n\n  function MenuItemsPage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MenuItemsPage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MenuItemsPage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      menuItems: [],\n      categories: []\n    };\n    _this.componentDidMount =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var categories, category, menuItems, itemsByCategory;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return api.getCategories();\n\n            case 2:\n              categories = _context.sent;\n\n              _this.setState({\n                categories: categories\n              });\n\n              category = getCategoryFromProps(_this.props);\n\n              if (category) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 8;\n              return api.getAllMenuItems();\n\n            case 8:\n              menuItems = _context.sent;\n\n              _this.setState({\n                menuItems: menuItems\n              });\n\n              return _context.abrupt(\"return\");\n\n            case 11:\n              _context.next = 13;\n              return api.getMenuItemsWithCategory(category);\n\n            case 13:\n              itemsByCategory = _context.sent;\n\n              _this.setState({\n                menuItems: itemsByCategory\n              });\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    _this.componentDidUpdate =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(prevProps) {\n        var prevCategory, nextCategory, menuItems, itemsByCategory;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                prevCategory = getCategoryFromProps(prevProps);\n                nextCategory = getCategoryFromProps(_this.props);\n\n                if (nextCategory) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                _context2.next = 5;\n                return api.getAllMenuItems();\n\n              case 5:\n                menuItems = _context2.sent;\n\n                _this.setState({\n                  menuItems: menuItems\n                });\n\n                return _context2.abrupt(\"return\");\n\n              case 8:\n                if (!(prevCategory === nextCategory)) {\n                  _context2.next = 10;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 10:\n                _context2.next = 12;\n                return api.getMenuItemsWithCategory(nextCategory);\n\n              case 12:\n                itemsByCategory = _context2.sent;\n\n                _this.setState({\n                  menuItems: itemsByCategory\n                });\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.handleOnCategoryChange = function (category) {\n      var _this$props = _this.props,\n          history = _this$props.history,\n          location = _this$props.location;\n      history.push({\n        pathname: location.pathname,\n        search: \"category=\".concat(category)\n      });\n    };\n\n    _this.handleGoBack = function () {\n      var history = _this.props.history;\n      history.push('/');\n    };\n\n    return _this;\n  }\n\n  _createClass(MenuItemsPage, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          menuItems = _this$state.menuItems,\n          categories = _this$state.categories;\n      var currentCategory = getCategoryFromProps(this.props);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, \"Menu Page\"), React.createElement(\"button\", {\n        type: \"button\",\n        onClick: this.handleGoBack,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, \"\\u041D\\u0430 \\u0433\\u043B\\u0430\\u0432\\u043D\\u0443\\u044E \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443\"), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }), React.createElement(CategorySelector, {\n        options: categories,\n        onChange: this.handleOnCategoryChange,\n        value: currentCategory,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }), currentCategory && React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, \"\\u0422\\u0435\\u043A\\u0443\\u0449\\u0438\\u0439 \\u0444\\u0438\\u043B\\u044C\\u0442\\u0440: \", currentCategory), React.createElement(ClearFilter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }), React.createElement(MenuList, {\n        menuItems: menuItems,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return MenuItemsPage;\n}(Component);\n\nexport default withRouter(MenuItemsPage);","map":{"version":3,"sources":["C:\\Vova\\react-GoIT-course\\foody-adminPage\\src\\components\\Admin\\Pages\\Menu\\MenuItemsPage.js"],"names":["React","Component","withRouter","queryString","api","MenuList","CategorySelector","ClearFilter","getCategoryFromProps","props","parse","location","search","category","MenuItemsPage","state","menuItems","categories","componentDidMount","getCategories","setState","getAllMenuItems","getMenuItemsWithCategory","itemsByCategory","componentDidUpdate","prevProps","prevCategory","nextCategory","handleOnCategoryChange","history","push","pathname","handleGoBack","currentCategory"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport queryString from 'query-string';\r\n\r\nimport * as api from '../../../../services/menu-api';\r\n\r\nimport MenuList from './MenuList';\r\nimport CategorySelector from './CategorySelector';\r\nimport ClearFilter from './ClearFilter';\r\n\r\nconst getCategoryFromProps = props =>\r\n  queryString.parse(props.location.search).category;\r\n\r\nclass MenuItemsPage extends Component {\r\n  state = {\r\n    menuItems: [],\r\n    categories: [],\r\n  };\r\n\r\n  componentDidMount = async () => {\r\n    const categories = await api.getCategories();\r\n    this.setState({ categories });\r\n\r\n    const category = getCategoryFromProps(this.props);\r\n    if (!category) {\r\n      const menuItems = await api.getAllMenuItems();\r\n      this.setState({ menuItems });\r\n      return;\r\n    }\r\n\r\n    const itemsByCategory = await api.getMenuItemsWithCategory(category);\r\n    this.setState({ menuItems: itemsByCategory });\r\n  };\r\n\r\n  componentDidUpdate = async prevProps => {\r\n    const prevCategory = getCategoryFromProps(prevProps);\r\n    const nextCategory = getCategoryFromProps(this.props);\r\n\r\n    if (!nextCategory) {\r\n      const menuItems = await api.getAllMenuItems();\r\n      this.setState({ menuItems });\r\n      return;\r\n    }\r\n\r\n    if (prevCategory === nextCategory) return;\r\n\r\n    const itemsByCategory = await api.getMenuItemsWithCategory(nextCategory);\r\n    this.setState({ menuItems: itemsByCategory });\r\n  };\r\n\r\n  handleOnCategoryChange = category => {\r\n    const { history, location } = this.props;\r\n    history.push({\r\n      pathname: location.pathname,\r\n      search: `category=${category}`,\r\n    });\r\n  };\r\n\r\n  handleGoBack = () => {\r\n    const { history } = this.props;\r\n    history.push('/');\r\n  };\r\n\r\n  render() {\r\n    const { menuItems, categories } = this.state;\r\n    const currentCategory = getCategoryFromProps(this.props);\r\n    return (\r\n      <div>\r\n        <h1>Menu Page</h1>\r\n        <button type=\"button\" onClick={this.handleGoBack}>\r\n          На главную страницу\r\n        </button>\r\n        <hr />\r\n        <CategorySelector\r\n          options={categories}\r\n          onChange={this.handleOnCategoryChange}\r\n          value={currentCategory}\r\n        />\r\n        <br />\r\n        {currentCategory && <h2>Текущий фильтр: {currentCategory}</h2>}\r\n        <ClearFilter />\r\n        <hr />\r\n        <MenuList menuItems={menuItems} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(MenuItemsPage);\r\n"]},"metadata":{},"sourceType":"module"}